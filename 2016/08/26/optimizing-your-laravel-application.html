<!DOCTYPE html> <html> <head> <title>Optimizing Your Laravel Application</title> <meta charset="utf-8" /> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="Good source for web development tutorial and technology article." /> <meta property="og:type" content="article" /> <meta property="og:site_name" content="ZeekLab" /> <meta property="og:title" content="Optimizing Your Laravel Application" /> <meta property="og:description" content="Good source for web development tutorial and technology article." /> <meta property="og:url" content="https://krisanalfa.github.io/2016/08/26/optimizing-your-laravel-application.html" /> <meta property="og:image" content="https://krisanalfa.github.io/images/programming.jpg" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Optimizing Your Laravel Application" /> <meta name="twitter:description" content="Good source for web development tutorial and technology article." /> <meta name="twitter:url" content="https://krisanalfa.github.io/2016/08/26/optimizing-your-laravel-application.html" /> <meta name="twitter:image" content="https://krisanalfa.github.io/images/programming.jpg" /> <meta name="twitter:site" content="@krisanalfa" /> <link rel="alternate" href="/feed.xml" type="application/rss+xml" title="Optimizing Your Laravel Application" /> <link rel="canonical" href="/2016/08/26/optimizing-your-laravel-application.html" /> <link type="text/css" rel="stylesheet" href="/assets/styles.css"> <!--[if lt IE 9]> <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script> <![endif]--> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-78621838-1', 'auto'); ga('send', 'pageview'); </script> </head> <body> <header class="animated fadeInDownBig"> <a href="/" title="Back to Homepage" class="logo">ZeekLab Blog</a> <button class="toggle">Menu</button> <nav> <ul> <li><a href="/" title="Home">Home</a></li> <li><a href="/2017/01/20/vue-js-compared-to-angular-2.html" title="Vue.js Compared to Angular 2">Vue.js Compared to Angular 2</a></li> </ul> </nav> </header> <section class="content"> <article> <header class="gradient-1" data-animation="fadeInDownBig"> <div class="overlay" style="background-image: url(/images/programming.jpg);" data-parallax="9"> </div> <div class="excerpt"> <span class="title">6 minutes</span> <h1><a href="/2016/08/26/optimizing-your-laravel-application.html" title="Optimizing Your Laravel Application">Optimizing Your Laravel Application</a></h1> <p>Here's what you can do to optimize your Laravel based application on production.</p> <span class="meta">Published <b>Aug 26, 2016</b></span> </div> <a href="#" title="Scroll" class="scroll">Scroll</a> </header> <div class="body" data-animation="fadeInUp"> <p>A few days ago, I was busy to deploy an application to production server. Basically it’s an API application. After it’s deployed well, I tested it to know it’s performance. I was shocked when I knew that it’s performance is not so good. I have 8 Gigs VPS and with 512 Gigs SSD in my server, so I expected that it’s performance is much more better than my laptop performance. Then I tried to determine what should I do to maximize my app performance without refactorring. After doing some research and benchmarking, finnaly I did it! I made my application almost <strong>twice</strong> faster than before. So, here’s a list of what I did to maximize my Laravel based application back then.</p> <h2 id="update-your-compile-configuration">Update Your <code class="highlighter-rouge">compile</code> Configuration</h2> <p>Laravel has a nice feature which you can compile your <em>common</em> classes to a single big file. This is good, because reading this big file is faster than your PHP <code class="highlighter-rouge">spl_autoloader</code> jobs. To do this, open your <code class="highlighter-rouge">config/compile.php</code> file and add your <em>common</em> classes there.</p> <div class="language-php highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="k">return</span> <span class="p">[</span>

    <span class="cm">/*
    |--------------------------------------------------------------------------
    | Additional Compiled Classes
    |--------------------------------------------------------------------------
    |
    | Here you may specify additional classes to include in the compiled file
    | generated by the `artisan optimize` command. These should be classes
    | that are included on basically every request into the application.
    |
    */</span>

    <span class="s1">'files'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="c1">//
</span>    <span class="p">],</span>

    <span class="c1">// [... OMMITED ...]
</span>
<span class="p">];</span>

</code></pre></div> <p>Here’s the deal, insert your <em>common</em> classes in <code class="highlighter-rouge">files</code> key. Here’s some keys you need to know before putting your classes into compile service provider:</p> <ul> <li>Remember, it’s better to store <em>common</em> classes in compiled class if that class is included on every request to your application.</li> <li>If you’re unsure whether it’s already compiled (as default) by Laravel, or maybe you need some example, read it’s default compiled classes in:</li> </ul> <div class="highlighter-rouge"><pre class="highlight"><code>vendor/laravel/framework/src/Illuminate/Foundation/Console/Optimize/config.php
</code></pre></div> <ul> <li><strong>DON’T</strong> add the same class or even class name into your compiled classes.</li> <li>The same rule is also applied in <code class="highlighter-rouge">providers</code> key.</li> </ul> <h2 id="optimize-your-composer-autoloader">Optimize Your Composer Autoloader.</h2> <p>By default, your Composer autoloader includes <code class="highlighter-rouge">dev</code> libraries. To ignore these libraries, issue this command to your command line:</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ composer dump-autoload --no-dev --optimize
</code></pre></div> <h2 id="configuration-caching">Configuration Caching</h2> <p>Laravel can cache it’s configuration to a single file, so there’s no need to loop each files inside <code class="highlighter-rouge">config</code> folder and requiring it one by one. To do so, issue this command to your command line:</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ php artisan config:cache
</code></pre></div> <p>Your <em>compiled</em> config should be stored under <code class="highlighter-rouge">bootstrap/cache/config.php</code>. In some cases, you’re already removed a library (service provider) with Composer, you’ll never be able to run <code class="highlighter-rouge">php artisan</code> since some provider(s) has not installed anymore, you should remove <code class="highlighter-rouge">bootstrap/cache/config.php</code> manually.</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ rm bootstrap/cache/config.php
</code></pre></div> <p>After doing this, you should be able to run <code class="highlighter-rouge">php artisan</code> again and also cache you application configuration like that bright day.</p> <h2 id="route-caching">Route Caching</h2> <p>Laravel also can cache your route’s file into a single file. Here Laravel will decode and unserialize the <code class="highlighter-rouge">RouteCollection</code> instance that holds all of the route information for an application. It allows Laravel to instantaneously load the entire route map into the router. To cache your route collection. fire this command:</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ php artisan route:cache
</code></pre></div> <blockquote> <p><strong>NOTES</strong>: You cannot cache your route file if there’s a callack based route as your route handler. Eg:</p> </blockquote> <div class="language-php highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="nx">Route</span><span class="o">::</span><span class="na">get</span><span class="p">(</span><span class="s1">'/user'</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">Illuminate\Http\Request</span> <span class="nv">$request</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">();</span>
<span class="p">})</span><span class="o">-&gt;</span><span class="na">middleware</span><span class="p">(</span><span class="s1">'auth:api'</span><span class="p">);</span>
</code></pre></div> <p>You should use Controller based handler to do this. First, make a controller:</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ php artisan make:controller Api/UserController
</code></pre></div> <div class="language-php highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="c1">// File: app/Http/Controllers/Api/AuthController.php
</span>
<span class="k">namespace</span> <span class="nx">App\Http\Controllers\Api</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">App\Http\Requests</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Http\Request</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">App\Http\Controllers\Controller</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">AuthController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">user</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">user</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <p>After this you can cache your route like that gold day.</p> <h2 id="jit-compiler">JIT Compiler</h2> <p>PHP is not understood natively by computers. You can’t compile it to bytecode and have machines running it. It must be done through a middleman, like the zend engine, that inteprets your php files and executes C routines accordingly. As you might guess, this is slow. Everytime your server runs a php file, it has to convert it to tokens - done by the AST parser and intepret it. It unfortunately has to compile it every single time, even though it gets the same result.</p> <p>For your application to act fast, you need a compile it once, run it every time method, and this is what a JIT compiler is about.</p> <p>The recommended JIT compiler for Laravel is <a href="http://hhvm.com/">HHVM</a>, created and used extensively by Facebook. It’s also used by Wikipedia, Etsy and thousands of others.</p> <h2 id="choose-a-faster-cache-and-session-driver">Choose a Faster Cache and Session Driver</h2> <p>Saving sessions in files is a quick and decent enough method that’s been used since the beggining of PHP’s time. But if you’re looking for performance, the filesystem is one of the things you should watch for, as it’s slow. A better method is storing the cache and session entries in RAM, since it provides a way faster access to the data. Luckily for you, laravel supports a few caching and session drivers that store data in RAM.</p> <p>My recommendation for the cache and the session driver is <a href="https://memcached.org/">Memcached</a> or <a href="http://redis.io/">Redis</a>, but you can choose whatever you like, as long as it works with RAM memory.</p> <h2 id="other-considerations">Other Considerations</h2> <p>Are you building an API or a really simple application that doesn’t require a “full stack” framework? If so, consider <a href="https://lumen.laravel.com/">Lumen</a>, a micro-framework that has the same elegance in mind as Laravel, just without a lot of additional libraries you may not need. Lumen is stateless, so complicated authentication and session management is replaced to leverage API tokens or headers.</p> <p>Another consideration is “Trimming Your Response Data”. For example: your <code class="highlighter-rouge">goods</code> may have a collection of <code class="highlighter-rouge">couriers</code>, and each of those <code class="highlighter-rouge">couriers</code> has a basic biography, which also includes a list of events (and their related locations) that they are appearing at over the next three years. When you return a large list of <code class="highlighter-rouge">goods</code>, regardless of how fast the query completes, passing all of this related data increases the data return size, and causes a delay as the client waits for the data.</p> <p>If you don’t need all of this data, then you’ve wasted a lot of time (and bandwidth) in your app. The solution to this is to use <code class="highlighter-rouge">View Models</code> an optimized subset of data from your data models, containing only the data elements you need for display. If you’re building an API or returning JSON data, you can use a library such as <a href="http://fractal.thephpleague.com/">Fractal</a> to easily translate your object model data and include only what you need.</p> <h2 id="conclusion">Conclusion</h2> <p>Laravel provides a great framework and good performance out of the box. As your code grows more complex, you may need to optimize a few things for increased performance, and these tricks should help you along the way. Happy code!</p> </div> <footer> <div class="meta"> <div class="author" data-animation="fadeInUp"> <span class="title">Written by</span> <h4>Krisan Alfa Timur</h4> <p>I'm an expert Web Developer who joins the Open Source realm as a Lumen evangelist.</p> <ul> <li><a href="https://twitter.com/krisanalfa" title="Twitter" class="icon twitter">Twitter</a></li> <li><a href="https://facebook.com/KrisanAlfa.T" title="Facebook" class="icon facebook">Facebook</a></li> <li><a href="https://plus.google.com/+KrisanAlfaTimur" title="Google" class="icon google">Google</a></li> <li><a href="https://www.linkedin.com/in/krisanalfa" title="LinkedIn" class="icon linkedin">LinkedIn</a></li> <li><a href="https://pinterest.com/krisanalfa" title="Pinterest" class="icon pinterest">Pinterest</a></li> <li><a href="https://flickr.com/krisanalfa" title="Flickr" class="icon flickr">Flickr</a></li> </ul> </div> <div class="share" data-animation="fadeInUp"> <span class="title">Share</span> <ul> <li><a href="https://twitter.com/home?status=Good%20source%20for%20web%20development%20tutorial%20and%20technology%20article.%20https://krisanalfa.github.io/2016/08/26/optimizing-your-laravel-application.html" title="Tweet" class="icon twitter">Tweet</a></li> <li><a href="https://www.facebook.com/sharer/sharer.php?u=https://krisanalfa.github.io/2016/08/26/optimizing-your-laravel-application.html" title="Like" class="icon facebook">Like</a></li> <li><a href="https://plus.google.com/share?url=https://krisanalfa.github.io/2016/08/26/optimizing-your-laravel-application.html" title="+1" class="icon google">+1</a></li> </ul> </div> </div> <div class="comments" data-animation="fadeInUp"> <span class="title">Comments</span> <div id="disqus_thread"></div> <script type="text/javascript"> var disqus_shortname = 'krisanalfa'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <noscript> Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript> </div> <div class="pagination" data-animation="fadeInUp"> <a href="/2016/08/22/shared-cache-between-laravel-and-node-js-using-redis.html" title="View Older Posts" class="button older">Older</a> <a href="/2016/08/29/benchmarking-optimized-laravel-vs-unoptimized-laravel.html" title="View Newer Posts" class="button newer">Newer</a> </div> </footer> </article> </section> <section class="teaser gradient-1" data-animation="fadeInUp"> <div class="excerpt"> <span class="title">6 minutes</span> <h1><a href="/2016/08/22/shared-cache-between-laravel-and-node-js-using-redis.html" title="Shared Cache Between Laravel and node.js Using Redis">Shared Cache Between Laravel and node.js Using Redis</a></h1> <p>Cache Sharing Between Laravel and node.js Using Redis</p> <span class="meta">Published <b>Aug 22, 2016</b> in <b></b></span> </div> </section> <footer data-animation="fadeInUp"> <div class="copyright"> <b>Copyright 2016 Krisan Alfa Timur.</b> All Rights Reserved. <a href="mailto:krisan47@gmail.com" title="Send E-Mail">Contact</a> <a href="/feed.xml" title="Subscribe to Feed">RSS</a> </div> </footer> <script type="text/javascript" src="/assets/scripts.js"></script> </body> </html>
